events {

}

http {
    resolver 127.0.0.11;

    server {
        listen 80;
        server_name localhost;  # Replace with your actual domain name

        # Route requests for /v2/templates/{template-id}/worker/{worker-name}/<whatever> to port 9001
        location ~ ^/v2/templates/[^/]+/worker/[^/]+/(.*)$ {
            proxy_pass http://golem-worker-service:9005/$1;
            # Add any additional proxy settings if needed
        }

        # Route other requests for /v2/templates/{template-id}/<whatever> to port 8080
        location ~ ^/v2/templates/[^/]+/(.*)$ {
            proxy_pass http://golem-template-service:9881/$1;
            # Add any additional proxy settings if needed
        }

        # Add other server configuration settings if needed
    }
}