enable_tracing_console = false
enable_json_log = false

grpc_address = "0.0.0.0"
http_address = "0.0.0.0"

http_port = 8082
port = 9000

[memory]
# system_memory_override = 4294967296
worker_memory_ratio = 0.8
worker_estimate_coefficient = 1.1

[key_value_storage]
type = "Redis"

[key_value_storage.config]
host = "localhost"
port = 6380
database = 0
tracing = false
pool_size = 8
key_prefix = ""

[key_value_storage.config.retries]
max_attempts = 5
min_delay = "100ms"
max_delay = "2s"
multiplier = 2

[indexed_storage]
type = "KVStoreRedis"

[blob_storage]
type = "LocalFileSystem"

[blob_storage.config]
root = "../data/blob_storage"

# S3 defaults
# region
# aws_endpoint_url
object_prefix = ""
compilation_cache_bucket = "compilation-cache"
custom_data_bucket = "custom-data"
oplog_payload_bucket = "oplog-payload"
compressed_oplog_buckets = ["oplog-archive-1"]
use_minio_credentials = false

[blob_storage.config.retries]
max_attempts = 3
min_delay = "100ms"
max_delay = "1s"
multiplier = 3

[oplog]
max_operations_before_commit = 128
max_payload_size = 65536
indexed_storage_layers = 2
blob_storage_layers = 1
entry_count_limit = 1024
archive_interval = "24h"

[limits]
max_active_workers = 1024
concurrency_limit_per_connection = 1024
max_concurrent_streams = 1024
event_broadcast_capacity = 16
event_history_size = 128
fuel_to_borrow = 10000
epoch_interval = "10ms"
epoch_ticks = 1

[retry]
max_attempts = 3
min_delay = "100ms"
max_delay = "1s"
multiplier = 3

[component_cache]
max_capacity = 32
time_to_idle = "12h"

[component_service]
type = "Grpc"

[component_service.config]
max_component_size = 52428800                         # 50 Mb
host = "localhost"
port = 9090
access_token = "2A354594-7A63-4091-A46B-CC58D379F677"

[component_service.config.retries]
max_attempts = 3
min_delay = "100ms"
max_delay = "1s"
multiplier = 3

[compiled_component_service]
type = "Enabled"
[compiled_component_service.config]

[shard_manager_service]
type = "Grpc"

[shard_manager_service.config]
host = "localhost"
port = 9002

[shard_manager_service.config.retries]
max_attempts = 5
min_delay = "100ms"
max_delay = "2s"
multiplier = 2

[scheduler]
refresh_interval = "2s"

[suspend]
suspend_after = "10s"

[active_workers]
drop_when_full = 0.25
ttl = "8h"

[invocation_keys]
pending_key_retention = "1m"
confirm_queue_capacity = 1024

[public_worker_api]
host = "localhost"
port = 9007
access_token = "2A354594-7A63-4091-A46B-CC58D379F677"
